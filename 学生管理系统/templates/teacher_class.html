<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>学生成绩管理系统</title>
    <link rel="icon" href="../favicon.ico">
    <link rel="stylesheet" type="text/css" href="../static/css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="../static/css/main.css"/>
    <script src="../static/js/jquery-3.3.1.min.js"></script>
    <script src="../static/js/bootstrap.min.js"></script>


</head>

<body>
<div class="container">
    <div class="header">
        <span class="left">老 师 开 设 课 程 查 看</span>
        <span class="right">你 好，{{user_info}}管 理 员!</span>
        <span class="right_right"><a href="/">退出登陆</a></span>
    </div>
    <div class="leftside">
        <ul>
            <li><a href="/student">学生信息录入</a></li>
            <li><a href ="/updata_student">学生信息修改</a></li>
            <li class="first"><a href="#">老师开设课程查看</a></li>
            <li><a href="/teacher">选课信息录入</a></li>
            <li><a href="/grade">成绩信息录入</a></li>
            <li><a href="/grade_infos">学生成绩查看</a></li>
            <li><a href="/graduation">毕业去向</a></li>
            <li><a href="/adminstator">系统管理员变动</a></li>
            <li><a href="/classes">班级管理</a></li>

        </ul>

    </div>
    <div class="container-fluid">
        <h1 class="sub-header">老 师 开 设 课 程 查 看</h1>
        &nbsp;&nbsp;
        <hr>
        <div class="row">
            <div class="col-md-12">
                <form action="" method="get" class="form-inline">
                    <div class="form-group">
                        <label for="teacher_name">教师名称:</label>
                        <input type="text" class="form-control" id="teacher_name" name="teacher_name" placeholder="请输入教师名称" value="{{teacher_name}}">
                    </div>
                    <div class="form-group">
                        <label for="search_class">开设课程:</label>
                        <input type="text" class="form-control" id="search_class" name="search_class" placeholder="请输入课程名称" value="{{search_class}}">
                    </div>
                    <button type="submit" class="btn btn-primary">搜索</button>
        <button type="button" class="btn btn-success" data-toggle="modal" data-target="#addModal">新增</button>
                </form>
            </div>
        </div>
        <div class="table-responsive">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>教师名称</th>
                        <th>开设课程1</th>
                        <th>开设课程2</th>
                        <th>开设课程3</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody>
                    {% for result in results %}
                    <tr>
                        <td>{{result[0]}}</td>
                        <td>{{result[1]}}</td>
                        <td>{{result[2]}}</td>
                        <td>{{result[3]}}</td>
                        <td>
                            <button type="button" class="btn btn-info btn-sm edit-btn" data-toggle="modal" data-target="#editModal" data-teacher="{{result[0]}}" data-class1="{{result[1]}}" data-class2="{{result[2]}}" data-class3="{{result[3]}}">编辑</button>
                            <button type="button" class="btn btn-danger btn-sm delete-btn" data-teacher="{{result[0]}}">删除</button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <!-- 分页 -->
        <div class="row">
            <div class="col-md-12">
                <div class="pagination-container">
                    <nav aria-label="Page navigation">
                        <ul class="pagination">
                            {% if page > 1 %}
                            <li>
                                <a href="{{ url_for('teacher_class', page=page-1, teacher_name=teacher_name, search_class=search_class) }}" aria-label="Previous">
                                    <span aria-hidden="true">&laquo;</span>
                                </a>
                            </li>
                            {% endif %}
                            
                            {% for i in range(1, total_pages+1) %}
                            <li {% if page == i %}class="active"{% endif %}>
                                {% if page == i %}
                                <span>{{i}}</span>
                                {% else %}
                                <a href="{{ url_for('teacher_class', page=i, teacher_name=teacher_name, search_class=search_class) }}">{{i}}</a>
                                {% endif %}
                            </li>
                            {% endfor %}
                            
                            {% if page < total_pages %}
                            <li>
                                <a href="{{ url_for('teacher_class', page=page+1, teacher_name=teacher_name, search_class=search_class) }}" aria-label="Next">
                                    <span aria-hidden="true">&raquo;</span>
                                </a>
                            </li>
                            {% endif %}
                        </ul>
                    </nav>
                    <div class="pagination-info">
                        <span>共 {{total}} 条记录</span>
                        <span>跳转到</span>
                        <input type="number" id="jumpPage" min="1" max="{{total_pages}}" value="{{page}}">
                        <button onclick="jumpToPage()">确定</button>
                    </div>
                </div>
            </div>
        </div>
        <script>
        $(document).ready(function() {
            function jumpToPage() {
                var page = document.getElementById('jumpPage').value;
                var teacher_name = '{{teacher_name}}';
                var search_class = '{{search_class}}';
                var url = '/teacher_class?page=' + page;
                if (teacher_name) {
                    url += '&teacher_name=' + encodeURIComponent(teacher_name);
                }
                if (search_class) {
                    url += '&search_class=' + encodeURIComponent(search_class);
                }
                window.location.href = url;
            }
            
            // 编辑按钮点击事件
            $('.edit-btn').click(function() {
                var teacher = $(this).data('teacher');
                var class1 = $(this).data('class1');
                var class2 = $(this).data('class2');
                var class3 = $(this).data('class3');
                
                $('#editTeacher').val(teacher);
                $('#editClass1').val(class1);
                $('#editClass2').val(class2);
                $('#editClass3').val(class3);
            });
            
            // 删除按钮点击事件
            $('.delete-btn').click(function() {
                var teacher = $(this).data('teacher');
                if (confirm('确定要删除该教师的课程信息吗？')) {
                    window.location.href = '/delete_teacher_class?teacher_id=' + encodeURIComponent(teacher);
                }
            });
        });
        </script>
    </div>
    
    <!-- 新增模态框 -->
    <div class="modal fade" id="addModal" tabindex="-1" role="dialog" aria-labelledby="addModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="addModalLabel">新增老师开设课程</h4>
                </div>
                <form action="/add_teacher_class" method="post">
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="addTeacher">老师名称</label>
                            <input type="text" class="form-control" id="addTeacher" name="teacher_id" required>
                        </div>
                        <div class="form-group">
                            <label for="addClass1">开设课程1</label>
                            <input type="text" class="form-control" id="addClass1" name="class1" required>
                        </div>
                        <div class="form-group">
                            <label for="addClass2">开设课程2</label>
                            <input type="text" class="form-control" id="addClass2" name="class2" required>
                        </div>
                        <div class="form-group">
                            <label for="addClass3">开设课程3</label>
                            <input type="text" class="form-control" id="addClass3" name="class3" required>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                        <button type="submit" class="btn btn-primary">保存</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- 编辑模态框 -->
    <div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="editModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="editModalLabel">编辑老师开设课程</h4>
                </div>
                <form action="/edit_teacher_class" method="post">
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="editTeacher">老师名称</label>
                            <input type="text" class="form-control" id="editTeacher" name="teacher_id" required readonly>
                        </div>
                        <div class="form-group">
                            <label for="editClass1">开设课程1</label>
                            <input type="text" class="form-control" id="editClass1" name="class1" required>
                        </div>
                        <div class="form-group">
                            <label for="editClass2">开设课程2</label>
                            <input type="text" class="form-control" id="editClass2" name="class2" required>
                        </div>
                        <div class="form-group">
                            <label for="editClass3">开设课程3</label>
                            <input type="text" class="form-control" id="editClass3" name="class3" required>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                        <button type="submit" class="btn btn-primary">保存</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
</body>

</html>